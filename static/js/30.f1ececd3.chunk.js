(window.webpackJsonp=window.webpackJsonp||[]).push([[30],{1823:function(e,t,a){"use strict";a.r(t);var n=a(419),r=a(422),o=a(425),i=a(424),s=(a(501),a(0)),l=a.n(s),c=a(112),u=a(9),d=a(1220),h=a(110),p=a(1219),f=a.n(p),m=a(1787),g=a(1171),b=(a(955),a(953)),v=a(1007),y=a.n(v),E=a(403),k=a(1009),w=(a(1188),[]),x=[],S=[],O={items:""};function N(e,t){var a=[];for(var n in e)if(e[n].parent_origin==t&&"false"!=e[n].access_view){var r=N(e,e[n].menu_id);r.length&&""==e[n].url?(e[n].children=r,a.push(e[n])):""!=e[n].url&&a.push(e[n])}return a}var R=function(){var e=Object(k.a)(y.a.mark(function e(){var t,a,n,r,o,i,s,l;return y.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=localStorage.getItem("id_token"),a={method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},body:JSON.stringify({key:t,info_data:"all"})},e.prev=2,e.next=5,fetch("https://adaproregualorapi.herokuapp.com/credential_service/get_menu",a);case 5:return n=e.sent,e.next=8,n.json();case 8:r=e.sent,[],r.dataOrigin,O.items=r.dataChanged,w.push(N(r.dataOrigin,"")),N(r.dataOrigin,""),x.push({path:"/",exact:!0,name:"Home"}),x.push({path:"/dashboard",name:"Dashboard"}),o=[],i=Object(E.a)(r.dataOrigin);try{for(i.s();!(s=i.n()).done;)""!=(l=s.value).url&&"false"!=l.access_view&&(x.push({path:l.url,name:l.name}),S.push(l)),""!=l.url&&o.push({Name:l.name,View:"true",Create:"true",Update:"true",Delete:"true"})}catch(c){i.e(c)}finally{i.f()}return w.push(x),w.push(S),w.push(o),e.abrupt("return",w);case 25:return e.prev=25,e.t0=e.catch(2),e.abrupt("return",e.t0);case 28:case"end":return e.stop()}},e,null,[[2,25]])}));return function(){return e.apply(this,arguments)}}(),j=(a(404),localStorage.getItem("id_token"),a(1004)),I=a(645);a(1016);var T=a(1785),_=a(1786),M=a(1019),A=a(1018),P=a.n(A),C=a(1218),z=a.n(C),L=(a(1211),new(a(1212).w3cwebsocket)("wss://adaproregualorapi.herokuapp.com")),$=function(e){var t=e.treeItems,a=e.create,n=e.update,r=e.delete1,o=e.read;return l.a.createElement(T.a,{style:{height:264,flexGrow:1,maxWidth:400},defaultCollapseIcon:l.a.createElement(P.a,null),defaultExpandIcon:l.a.createElement(z.a,null),defaultEndIcon:l.a.createElement("div",{style:{width:24}})},W(t,a,n,r,o))},D=Object(j.a)(function(e){return{root:{"&:hover > $content":{backgroundColor:"black"},"&:focus > $content, &$selected > $content":{backgroundColor:"black"},"&:focus > $content $label, &:hover > $content $label, &$selected > $content $label":{backgroundColor:"black"}},content:{borderTopRightRadius:e.spacing(2),borderBottomRightRadius:e.spacing(2),paddingRight:e.spacing(1),fontWeight:e.typography.fontWeightMedium,"$expanded > &":{fontWeight:e.typography.fontWeightRegular}},group:{marginLeft:10,borderLeft:"1px dashed white","& $content":{paddingLeft:e.spacing(1),marginLeft:-5}},expanded:{},selected:{},label:{fontWeight:"inherit",color:"inherit"},labelRoot:{display:"flex",alignItems:"center",padding:e.spacing(.5,0)},labelIcon:{marginRight:e.spacing(1)},labelText:{fontWeight:"inherit",flexGrow:1}}});var W=function e(t,a,n,r,o){var i=D();return t.map(function(t){var a=void 0;if(t.children&&t.children.length>0&&(a=e(t.children)),0!=t.length)return l.a.createElement(_.a,{key:t.menu_id,nodeId:t.menu_id,label:l.a.createElement("div",{className:i.labelRoot},""==t.url&&""==t.parent_origin?l.a.createElement(f.a,{className:i.labelIcon}):"",""!=t.url?l.a.createElement(c.b,{style:{textDecoration:"none",color:"white",width:"200%"},to:t.url},l.a.createElement(M.a,{className:i.labelText,variant:"body2"},t.name)):l.a.createElement(M.a,{className:i.labelText,variant:"body2"},t.name)),classes:{root:i.root,content:i.content,expanded:i.expanded,selected:i.selected,group:i.group,label:i.label},children:a})})},J=l.a.lazy(function(){return Promise.all([a.e(1),a.e(4),a.e(10),a.e(16),a.e(35)]).then(a.bind(null,1798))}),U=(l.a.lazy(function(){return Promise.all([a.e(0),a.e(1),a.e(10),a.e(15),a.e(28)]).then(a.bind(null,1803))}),l.a.lazy(function(){return Promise.all([a.e(0),a.e(1),a.e(2),a.e(3),a.e(14)]).then(a.bind(null,1832))})),B=l.a.lazy(function(){return Promise.all([a.e(0),a.e(1),a.e(2),a.e(3),a.e(21)]).then(a.bind(null,1833))}),H=l.a.lazy(function(){return Promise.all([a.e(0),a.e(1),a.e(2),a.e(3),a.e(22)]).then(a.bind(null,1834))}),G=l.a.lazy(function(){return Promise.all([a.e(0),a.e(1),a.e(2),a.e(3),a.e(20)]).then(a.bind(null,1835))}),Y=l.a.lazy(function(){return Promise.all([a.e(0),a.e(1),a.e(2),a.e(3),a.e(19)]).then(a.bind(null,1836))}),V=l.a.lazy(function(){return Promise.all([a.e(0),a.e(1),a.e(2),a.e(3),a.e(24)]).then(a.bind(null,1828))}),q=(l.a.lazy(function(){return Promise.all([a.e(0),a.e(2),a.e(25),a.e(29)]).then(a.bind(null,1837))}),l.a.lazy(function(){return Promise.all([a.e(4),a.e(7),a.e(9)]).then(a.bind(null,1795))}),l.a.lazy(function(){return a.e(33).then(a.bind(null,1822))})),F=l.a.lazy(function(){return a.e(34).then(a.bind(null,1820))}),K=l.a.lazy(function(){return Promise.all([a.e(4),a.e(27)]).then(a.bind(null,1821))}),Q=function(e){Object(o.a)(a,e);var t=Object(i.a)(a);function a(e){var r;return Object(n.a)(this,a),(r=t.call(this,e)).Auth=new I.a,r.createNotification=function(e){return function(){switch(e){case"info":g.NotificationManager.info("Info message");break;case"success":g.NotificationManager.success("Success message","Title here");break;case"warning":g.NotificationManager.warning("Warning message","Close after 3000ms",3e3);break;case"error":g.NotificationManager.error("Error message","Click me!",5e3,function(){alert("callback")})}}},r.loading=function(){return l.a.createElement("div",{className:"animated fadeIn pt-1 text-center"},"Loading...")},r._handleLogout=function(){r.Auth.logout(),r.props.history.replace("/login")},r.state={dataRoutes:[],dataAsidemenu:[],dataAccess:[],create:!1,update:!1,read:!1,delete:!1,coba:[],tanggal:"",reload:!1},r}return Object(r.a)(a,[{key:"componentWillMount",value:function(){var e=this;Promise.resolve(R()).then(function(t){return t.length>0?e.setState({dataAsidemenu:t[0],dataRoutes:t[1],dataAccess:t[2],coba:t[3]}):e._handleLogout()}),console.log(this.state.dataAsidemenu)}},{key:"componentDidUpdate",value:function(e,t,a){var n=this;console.log(this.state.reload),this.state.tanggal.toString()!=this.props.notif.date.toString()&&(this.setState({tanggal:this.props.notif.date}),"Berhasil Menambah User"==this.props.notif.message?L.send(JSON.stringify({type:"message",message:"Terdapat Data User Baru, Harap Reload Halaman",variant:"info",date:(new Date).toLocaleString()})):"Berhasil Menghapus User"!=this.props.notif.message&&L.send(JSON.stringify({type:"message",message:"Terdapat Data User Yang telah dihapus, Harap Reload Halaman",variant:"info",date:(new Date).toLocaleString()})),"success"==this.props.notif.variant?g.NotificationManager.success(this.props.notif.message,"Success",3e3):"error"==this.props.notif.variant?g.NotificationManager.error(this.props.notif.message,"Error",3e3):"warning"==this.props.notif.variant?g.NotificationManager.warning(this.props.notif.message,"Warning",3e3):"info"==this.props.notif.variant&&g.NotificationManager.info(this.props.notif.message,"Info",3e3)),L.onmessage=function(e){var t=JSON.parse(e.data);g.NotificationManager.info(t.message,"Info",3e3),n.setState({reload:!0})},console.log(this.state.dataAsidemenu),console.log(this.state.dataRoutes),console.log(this.state.coba),this.state.dataAccess&&(this.props.MenuAccess(this.state.dataAccess),this.props.MenuPilihan(this.state.coba))}},{key:"refreshPage",value:function(){window.location.reload(!1),this.setState({reload:!1})}},{key:"signOut",value:function(e){e.preventDefault(),this.props.history.replace("/login")}},{key:"render",value:function(){return l.a.createElement("div",{className:"app"},l.a.createElement(b.e,{fixed:!0},this.state.reload?l.a.createElement(m.a,{color:"primary",onClick:this.refreshPage,style:{position:"absolute",zIndex:20,marginLeft:"auto",marginRight:"auto",left:0,right:0},variant:"extended"},"Refresh"):"",l.a.createElement(s.Suspense,{fallback:this.loading()},l.a.createElement(K,{onLogout:this._handleLogout}))),l.a.createElement("div",{className:"app-body"},l.a.createElement(g.NotificationContainer,null),l.a.createElement(b.h,{fixed:!0,display:"lg"},l.a.createElement(b.k,null),l.a.createElement(b.j,null),l.a.createElement(s.Suspense,null,this.state.dataAsidemenu.length>0?l.a.createElement($,{treeItems:this.state.dataAsidemenu,create:this.state.create,read:this.state.read,delete1:this.state.delete,update:this.state.update}):""),l.a.createElement(b.i,null)),l.a.createElement("main",{className:"main"},l.a.createElement(b.c,{appRoutes:this.state.dataRoutes?this.state.dataRoutes:""}),l.a.createElement(d.a,{fluid:!0},l.a.createElement(s.Suspense,{fallback:this.loading()},this.state.dataRoutes.length>0?l.a.createElement(u.d,null,this.state.dataRoutes?this.state.dataRoutes.map(function(e,t){return l.a.createElement(u.b,{key:t,path:e.path,exact:e.exact},"Dashboard"==e.name?l.a.createElement(J,null):"user"==e.name?l.a.createElement(U,null):"role"==e.name?l.a.createElement(Y,null):"log action"==e.name?l.a.createElement(V,null):"group"==e.name?l.a.createElement(H,null):"department"==e.name?l.a.createElement(B,null):"branch"==e.name?l.a.createElement(G,null):l.a.createElement(J,null))}):"",l.a.createElement(u.a,{from:"/",to:"/dashboard"})):""))),l.a.createElement(b.a,{fixed:!0},l.a.createElement(s.Suspense,{fallback:this.loading()},l.a.createElement(q,null)))),l.a.createElement(b.d,null,l.a.createElement(s.Suspense,{fallback:this.loading()},l.a.createElement(F,null))))}}]),a}(s.Component),X=Object(h.connect)(function(e){return{notif:e.Notif}},function(e){return{accessuser:function(t,a,n,r){return e({type:"YES",payload:{accesscreate:t,accessview:a,accessupdate:n,accessdelete:r}})},MenuAccess:function(t){return e({type:"MenuAccess",payload:{data:t}})},MenuPilihan:function(t){return e({type:"MenuPilihan",payload:{data:t}})}}})(Q);t.default=function(e){var t=new I.a;return function(a){Object(o.a)(c,a);var s=Object(i.a)(c);function c(){var e;Object(n.a)(this,c);for(var t=arguments.length,a=new Array(t),r=0;r<t;r++)a[r]=arguments[r];return(e=s.call.apply(s,[this].concat(a))).state={confirm:null,loaded:!1},e}return Object(r.a)(c,[{key:"componentWillMount",value:function(){if(t.loggedIn())try{var e=t.getConfirm();console.log("confirmation is ",e),this.setState({confirm:e,loaded:!0})}catch(a){console.log(a),t.logout(),this.props.history.replace("/login")}else this.props.history.replace("/login")}},{key:"render",value:function(){return!0===this.state.loaded?this.state.confirm?(console.log("confirmed."),l.a.createElement(e,Object.assign({},this.props,{hisotry:this.props.history,confirm:this.state.confirm}))):(console.log("not confirmed."),null):null}}]),c}(s.Component)}(X)},404:function(e,t,a){"use strict";var n=a(644),r=a.n(n);t.a=r.a.create({baseURL:"https://adaproregualorapi.herokuapp.com/credential_service"})},645:function(e,t,a){"use strict";a.d(t,"a",function(){return s});var n=a(1),r=a(419),o=a(828),i=a.n(o),s=(a(110),function e(){var t=this;Object(r.a)(this,e),this.login=function(e,a){return t.fetch("https://adaproregualorapi.herokuapp.com/credential_service/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,password:a})}).then(function(e){return t.setToken(e.data),console.log(e.data),e})},this.loggedIn=function(){var e=t.getToken();return!!e&&!t.isTokenExpired(e)},this.isTokenExpired=function(e){try{return i()(e).exp<Date.now()/1e3}catch(t){return console.log("Token expired."),!1}},this.setToken=function(e){localStorage.setItem("id_token",e)},this.getToken=function(){return localStorage.getItem("id_token")},this.logout=function(){localStorage.removeItem("id_token")},this.getConfirm=function(){var e=i()(t.getToken());return console.log("Received answer."),e},this.fetch=function(e,a){var r={Accept:"application/json","Content-Type":"application/json"};return t.loggedIn()&&(r.Authorization="Bearer "+t.getToken()),fetch(e,Object(n.a)({headers:r},a)).then(t._checkStatus).then(function(e){return e.json()})},this._checkStatus=function(e){if(e.status>=200&&e.status<300)return e;var t=new Error(e.statusText);throw t.response=e,t}})}}]);
//# sourceMappingURL=30.f1ececd3.chunk.js.map